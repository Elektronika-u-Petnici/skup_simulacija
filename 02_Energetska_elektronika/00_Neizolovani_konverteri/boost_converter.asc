Version 4
SHEET 1 5024 2180
WIRE 128 -704 32 -704
WIRE 256 -704 128 -704
WIRE 1072 -704 976 -704
WIRE 1200 -704 1072 -704
WIRE -1072 -672 -1104 -672
WIRE -992 -672 -1072 -672
WIRE -832 -672 -912 -672
WIRE -672 -672 -752 -672
WIRE -576 -672 -672 -672
WIRE -432 -672 -512 -672
WIRE -320 -672 -432 -672
WIRE -272 -672 -320 -672
WIRE 32 -656 32 -704
WIRE 976 -656 976 -704
WIRE -432 -624 -432 -672
WIRE -1696 -592 -1744 -592
WIRE -1104 -560 -1104 -672
WIRE -672 -560 -672 -672
WIRE -272 -560 -272 -672
WIRE 32 -560 32 -576
WIRE 976 -560 976 -576
WIRE -1744 -528 -1744 -592
WIRE -432 -496 -432 -560
WIRE -848 -480 -880 -480
WIRE -720 -480 -768 -480
WIRE 112 -480 32 -480
WIRE 192 -480 112 -480
WIRE 1072 -480 976 -480
WIRE 1200 -480 1072 -480
WIRE 32 -432 32 -480
WIRE 976 -432 976 -480
WIRE -1744 -384 -1744 -448
WIRE -1104 -368 -1104 -480
WIRE -672 -368 -672 -464
WIRE -432 -368 -432 -416
WIRE -272 -368 -272 -480
WIRE 32 -336 32 -352
WIRE 976 -336 976 -352
FLAG -1696 -592 GATE_A
IOPIN -1696 -592 Out
FLAG -432 -368 0
FLAG -1104 -368 0
FLAG -880 -480 GATE_A
IOPIN -880 -480 In
FLAG -672 -368 0
FLAG -272 -368 0
FLAG -1744 -384 0
FLAG 32 -560 0
FLAG 32 -336 0
FLAG 128 -704 output_power
FLAG 112 -480 input_power
FLAG 976 -560 0
FLAG 1072 -704 efficiency
FLAG 976 -336 0
FLAG 1072 -480 losses
FLAG -1072 -672 vin
FLAG -320 -672 vout
SYMBOL voltage -1744 -544 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -468 103 Left 2
SYMATTR Value PULSE(0 10 {0} 10n 10n {d/f} {1/f})
SYMATTR InstName V2
SYMBOL cap -448 -624 R0
SYMATTR InstName C15
SYMATTR Value 22µ
SYMBOL res -896 -656 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value 45m
SYMBOL res -448 -400 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value 20m
SYMBOL voltage -1104 -576 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL res -752 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 5
SYMBOL nmos -720 -560 R0
SYMATTR InstName M5
SYMATTR Value IRFZ44N
SYMBOL schottky -576 -656 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D13
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -288 -576 R0
SYMATTR InstName R3
SYMATTR Value 50
SYMBOL ind2 -848 -656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value 10µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=0.2
SYMBOL bv 32 -672 R0
SYMATTR InstName B1
SYMATTR Value V= if(time >  start_time, idt(V(vout)*I(R3))/(time - start_time),0)
SYMBOL bv 32 -448 R0
SYMATTR InstName B2
SYMATTR Value V=if(time > start_time, -idt(V(vin)*I(V1)) / (time - start_time),0)
SYMBOL bv 976 -672 R0
SYMATTR InstName B3
SYMATTR Value V= min(max(V(output_power) / V(input_power),0), 1)
SYMBOL bv 976 -448 R0
SYMATTR InstName B4
SYMATTR Value V=  V(input_power) - V(output_power)
TEXT -2080 -512 Left 2 !.tran 100m
TEXT -2080 -488 Left 2 !.param f = 500k
TEXT -2080 -440 Left 2 !.param Lleak=1u
TEXT -2080 -464 Left 2 !.param d=0.5
TEXT 448 -688 Left 2 !.param start_time = 1m
